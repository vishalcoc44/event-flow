"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[975],{4370:(e,r,t)=>{t.d(r,{A:()=>o});var s=t(95155),a=t(48173),i=t.n(a),n=t(8315);function o(){return(0,s.jsx)("footer",{className:"bg-[#E8FBFD] py-16",children:(0,s.jsxs)("div",{className:"container mx-auto px-4",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row justify-between mb-12",children:[(0,s.jsxs)("div",{className:"mb-8 md:mb-0",children:[(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-primary rounded-md flex items-center justify-center mr-2",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-5 h-5",children:[(0,s.jsx)("path",{d:"M12.75 12.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM7.5 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM8.25 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM9.75 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM10.5 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM12.75 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM14.25 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM15 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM16.5 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM15 12.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM16.5 13.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M6.75 2.25A.75.75 0 0 1 7.5 3v1.5h9V3A.75.75 0 0 1 18 3v1.5h.75a3 3 0 0 1 3 3v11.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V7.5a3 3 0 0 1 3-3H6V3a.75.75 0 0 1 .75-.75Zm13.5 9a1.5 1.5 0 0 0-1.5-1.5H5.25a1.5 1.5 0 0 0-1.5 1.5v7.5a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5v-7.5Z",clipRule:"evenodd"})]})}),(0,s.jsx)("span",{className:"text-xl font-semibold text-gray-900",children:"EventFlow"})]}),(0,s.jsx)("p",{className:"text-gray-600 max-w-md mb-6",children:"EventFlow empowers you to create, promote, and manage stunning events with ease. From intimate workshops to grand conferences, we streamline everything."}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("a",{href:"#",className:"text-gray-400 hover:text-primary",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"})})}),(0,s.jsx)("a",{href:"#",className:"text-gray-400 hover:text-primary",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"})})}),(0,s.jsx)("a",{href:"#",className:"text-gray-400 hover:text-primary",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("rect",{x:"2",y:"2",width:"20",height:"20",rx:"5",ry:"5"}),(0,s.jsx)("path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"}),(0,s.jsx)("line",{x1:"17.5",y1:"6.5",x2:"17.51",y2:"6.5"})]})}),(0,s.jsx)("a",{href:"#",className:"text-gray-400 hover:text-primary",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"}),(0,s.jsx)("rect",{x:"2",y:"9",width:"4",height:"12"}),(0,s.jsx)("circle",{cx:"4",cy:"4",r:"2"})]})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Company"}),(0,s.jsxs)("ul",{className:"space-y-2",children:[(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/about",className:"text-gray-600 hover:text-primary",children:"About Us"})}),(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/careers",className:"text-gray-600 hover:text-primary",children:"Careers"})}),(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/blog",className:"text-gray-600 hover:text-primary",children:"Blog"})}),(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/press",className:"text-gray-600 hover:text-primary",children:"Press"})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Resources"}),(0,s.jsxs)("ul",{className:"space-y-2",children:[(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/help",className:"text-gray-600 hover:text-primary",children:"Help Center"})}),(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/guides",className:"text-gray-600 hover:text-primary",children:"Guides"})}),(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/partners",className:"text-gray-600 hover:text-primary",children:"Partners"})}),(0,s.jsx)("li",{children:(0,s.jsx)(i(),{href:"/webinars",className:"text-gray-600 hover:text-primary",children:"Webinars"})})]})]}),(0,s.jsxs)("div",{className:"col-span-2 md:col-span-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Stay in the Loop with EventFlow"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Subscribe to our newsletter for updates"}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("input",{type:"email",placeholder:"Your email address",className:"px-4 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-1 focus:ring-primary w-full"}),(0,s.jsx)(n.z,{variant:"primary",size:"sm",className:"rounded-l-none",children:"Subscribe"})]})]})]})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-8 flex flex-col md:flex-row justify-between items-center",children:[(0,s.jsx)("p",{className:"text-gray-500 text-sm mb-4 md:mb-0",children:"\xa9 2024 EventFlow. All rights reserved."}),(0,s.jsxs)("div",{className:"flex space-x-6",children:[(0,s.jsx)(i(),{href:"/terms",className:"text-gray-500 text-sm hover:text-primary",children:"Terms"}),(0,s.jsx)(i(),{href:"/privacy",className:"text-gray-500 text-sm hover:text-primary",children:"Privacy"}),(0,s.jsx)(i(),{href:"/cookies",className:"text-gray-500 text-sm hover:text-primary",children:"Cookies"}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"text-gray-500 text-sm mr-2",children:"English"}),(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-500",children:(0,s.jsx)("polyline",{points:"6 9 12 15 18 9"})})]})]})]})]})})}},47548:(e,r,t)=>{t.d(r,{A:()=>z});var s=t(95155),a=t(48173),i=t.n(a),n=t(12115),o=t(73312),l=t(8315),c=t(87248),d=t(21567);function h(e){let{children:r,href:t,className:a,isActive:n}=e;return(0,s.jsx)(i(),{href:t,children:(0,s.jsxs)(c.P.div,{className:(0,d.cn)("relative text-sm font-medium cursor-pointer",n?"text-primary":"text-gray-600 hover:text-gray-900",a),whileHover:{scale:1.05,transition:{duration:.15}},children:[r,(0,s.jsx)(c.P.div,{className:"absolute -bottom-1 left-0 right-0 h-0.5 bg-gradient-to-r from-primary to-primary/60",initial:{scaleX:0},whileHover:{scaleX:1},transition:{duration:.2}})]})})}var m=t(76046),x=t(17146),u=t(39569),g=t(67427),p=t(35288),y=t(98867),f=t(40767),v=t(45686),j=t(25121),b=t(22130),w=t(50959),N=t(25683),k=t(71714),_=t(1649);let E=e=>{let{className:r=""}=e,{notifications:t,unreadCount:a,markAsRead:i,markAllAsRead:l,deleteNotification:c,loading:d}=(0,w.E)(),[h,m]=(0,n.useState)(!1),[x,u]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=e=>{e.target.closest(".notification-bell")||m(!1)};return h&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[h]);let E=async e=>{await i(e)},C=async()=>{u(!0);try{await l()}finally{u(!1)}},L=async e=>{await c(e)},M=e=>{switch(e){case"EVENT_CREATED":case"CATEGORY_UPDATE":return"\uD83C\uDF89";case"EVENT_REMINDER":case"BOOKING_REMINDER":return"⏰";case"BOOKING_CONFIRMED":return"✅";case"FOLLOW_UPDATE":return"\uD83D\uDC65";default:return"\uD83D\uDCE2"}},D=e=>{switch(e){case"EVENT_REMINDER":case"BOOKING_REMINDER":return"bg-orange-100 text-orange-800 border-orange-200";case"BOOKING_CONFIRMED":return"bg-green-100 text-green-800 border-green-200";case"FOLLOW_UPDATE":return"bg-blue-100 text-blue-800 border-blue-200";case"EVENT_CREATED":case"CATEGORY_UPDATE":return"bg-purple-100 text-purple-800 border-purple-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}};return(0,s.jsxs)("div",{className:"notification-bell relative ".concat(r),children:[(0,s.jsx)(g.Wq,{className:"relative cursor-pointer p-2 rounded-lg",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.15,children:(0,s.jsxs)("div",{onClick:()=>m(!h),children:[(0,s.jsx)(p.A,{className:"w-5 h-5 text-gray-600"}),a>0&&(0,s.jsx)(j.E,{className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-xs bg-red-500 text-white border-2 border-white",variant:"destructive",children:a>99?"99+":a})]})}),(0,s.jsx)(N.N,{children:h&&(0,s.jsx)(k.P.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},className:"absolute right-0 top-full mt-2 w-80 max-h-96 overflow-hidden z-50",children:(0,s.jsxs)(b.Zp,{className:"shadow-xl border-0",children:[(0,s.jsx)(b.aR,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(b.ZB,{className:"text-lg font-semibold",children:"Notifications"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[a>0&&(0,s.jsxs)(o.$,{variant:"ghost",size:"sm",onClick:C,disabled:x,className:"text-xs h-7 px-2",children:[x?(0,s.jsx)("div",{className:"w-3 h-3 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"}):(0,s.jsx)(y.A,{className:"w-3 h-3"}),"Mark all read"]}),(0,s.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>m(!1),className:"h-7 w-7 p-0",children:(0,s.jsx)(f.A,{className:"w-4 h-4"})})]})]})}),(0,s.jsxs)(b.Wu,{className:"p-0",children:[(0,s.jsx)("div",{className:"max-h-80 overflow-y-auto",children:d?(0,s.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,s.jsx)("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin"})}):0===t.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)(p.A,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"No notifications yet"})]}):(0,s.jsx)("div",{className:"space-y-1",children:t.slice(0,10).map(e=>(0,s.jsx)(g.Wq,{className:"p-3 border-l-4 cursor-pointer transition-colors ".concat(e.is_read?"bg-gray-50 border-gray-200":"bg-white border-blue-500"),shadowColor:"rgba(0,0,0,0.05)",shadowIntensity:.1,children:(0,s.jsx)("div",{onClick:()=>E(e.id),children:(0,s.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,s.jsx)("div",{className:"text-lg",children:M(e.type)}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsx)("h4",{className:"text-sm font-medium ".concat(e.is_read?"text-gray-600":"text-gray-900"),children:e.title}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 ml-2",children:[(0,s.jsx)(o.$,{variant:"ghost",size:"sm",onClick:r=>{r.stopPropagation(),E(e.id)},className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,s.jsx)(y.A,{className:"w-3 h-3"})}),(0,s.jsx)(o.$,{variant:"ghost",size:"sm",onClick:r=>{r.stopPropagation(),L(e.id)},className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity text-red-500 hover:text-red-700",children:(0,s.jsx)(v.A,{className:"w-3 h-3"})})]})]}),(0,s.jsx)("p",{className:"text-xs mt-1 ".concat(e.is_read?"text-gray-500":"text-gray-700"),children:e.message}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,s.jsx)(j.E,{variant:"outline",className:"text-xs ".concat(D(e.type)),children:e.type.replace("_"," ").toLowerCase()}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:(0,_.m)(new Date(e.created_at),{addSuffix:!0})})]})]})]})})},e.id))})}),t.length>10&&(0,s.jsx)("div",{className:"border-t p-3 bg-gray-50",children:(0,s.jsxs)(o.$,{variant:"ghost",size:"sm",className:"w-full text-sm text-gray-600 hover:text-gray-900",onClick:()=>{window.location.href="/notifications"},children:["View all notifications (",t.length,")"]})})]})]})})})]})},C=()=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),L=()=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})}),M=()=>(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),D=()=>(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]});function z(e){let{onRegisterClick:r,onLoginClick:t}=e,a=(0,m.usePathname)(),[c,d]=(0,n.useState)(!1),[p,y]=(0,n.useState)(!1),{logout:f,user:v}=(0,x.A)(),{organization:j,orgLoading:b}=(0,u.rq)(),{isOwner:w,isAdmin:N,canManageMembers:k,canManageEventSpaces:_}=(0,u.Xn)(),z=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=e=>{z.current&&!z.current.contains(e.target)&&y(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let W=async()=>{try{await f()}catch(e){console.error("Logout error:",e)}};return(0,s.jsxs)("header",{className:"bg-white border-b border-gray-100 py-3",children:[(0,s.jsxs)("div",{className:"container mx-auto px-2 flex items-center",children:[(0,s.jsxs)(i(),{href:"/",className:"flex items-center flex-shrink-0 mr-6",children:[(0,s.jsx)("div",{className:"w-7 h-7 bg-primary rounded-md flex items-center justify-center mr-2",children:(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"white",className:"w-4 h-4",children:[(0,s.jsx)("path",{d:"M12.75 12.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM7.5 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM8.25 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM9.75 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM10.5 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM12.75 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM14.25 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM15 17.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM16.5 15.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM15 12.75a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM16.5 13.5a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"}),(0,s.jsx)("path",{fillRule:"evenodd",d:"M6.75 2.25A.75.75 0 0 1 7.5 3v1.5h9V3A.75.75 0 0 1 18 3v1.5h.75a3 3 0 0 1 3 3v11.25a3 3 0 0 1-3 3H5.25a3 3 0 0 1-3-3V7.5a3 3 0 0 1 3-3H6V3a.75.75 0 0 1 .75-.75Zm13.5 9a1.5 1.5 0 0 0-1.5-1.5H5.25a1.5 1.5 0 0 0-1.5 1.5v7.5a1.5 1.5 0 0 0 1.5 1.5h13.5a1.5 1.5 0 0 0 1.5-1.5v-7.5Z",clipRule:"evenodd"})]})}),(0,s.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:"EventFlow"})]}),v&&j&&(0,s.jsxs)("div",{className:"hidden md:block relative mr-4",ref:z,children:[(0,s.jsxs)("button",{onClick:()=>y(!p),className:"flex items-center space-x-2 px-2 py-1.5 text-sm font-medium text-gray-700 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[(0,s.jsx)(L,{}),(0,s.jsx)("span",{className:"max-w-[120px] truncate",children:j.name}),(0,s.jsx)(C,{})]}),p&&(0,s.jsxs)("div",{className:"absolute top-full left-0 mt-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(L,{}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-900",children:j.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:[j.subscription_plan," Plan"]})]})]})}),(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsxs)(i(),{href:"/organization/dashboard",className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",onClick:()=>y(!1),children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:[(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"})]}),(0,s.jsx)("span",{children:"Dashboard"})]}),(0,s.jsxs)(i(),{href:"/organization/events",className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",onClick:()=>y(!1),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3a2 2 0 012-2h4a2 2 0 012 2v4m-6 9l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 15a6 6 0 1012 0v-3H3v3z"})}),(0,s.jsx)("span",{children:"Events"})]}),k&&(0,s.jsxs)(i(),{href:"/organization/members",className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",onClick:()=>y(!1),children:[(0,s.jsx)(M,{}),(0,s.jsx)("span",{children:"Members"})]}),_&&(0,s.jsxs)(i(),{href:"/organization/spaces",className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",onClick:()=>y(!1),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),(0,s.jsx)("span",{children:"Event Spaces"})]}),w&&(0,s.jsxs)(i(),{href:"/organization/plans",className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",onClick:()=>y(!1),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 1.343-3 3s1.343 3 3 3 3-1.343 3-3-1.343-3-3-3zm0 10c-4.418 0-8-1.79-8-4V7c0-2.21 3.582-4 8-4s8 1.79 8 4v7c0 2.21-3.582 4-8 4z"})}),(0,s.jsx)("span",{children:"Plans & Pricing"})]}),w&&(0,s.jsxs)(i(),{href:"/organization/settings",className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",onClick:()=>y(!1),children:[(0,s.jsx)(D,{}),(0,s.jsx)("span",{children:"Settings"})]}),w&&(0,s.jsxs)(i(),{href:"/organization/onboarding",className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",onClick:()=>y(!1),children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,s.jsx)("span",{children:"Onboarding"})]})]})]})]}),(0,s.jsxs)("nav",{className:"hidden md:flex items-center space-x-3 flex-1",children:[((null==v?void 0:v.role)==="ADMIN"||(null==v?void 0:v.is_org_admin))&&(0,s.jsxs)("div",{className:"flex items-center space-x-3 flex-wrap",children:[(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/admin/dashboard",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/admin/dashboard")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Dashboard"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/admin/event",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/admin/event")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Add Event"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/admin/category",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/admin/category")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Categories"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/admin/events",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/admin/events")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Events"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/admin/bookings",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/admin/bookings")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Bookings"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/admin/customers",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/admin/customers")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Customers"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/admin/admin-requests",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/admin/admin-requests")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Requests"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/admin/register",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/admin/register")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Register"})})]}),(null==v?void 0:v.role)==="customer"&&(0,s.jsxs)("div",{className:"flex items-center space-x-3 flex-wrap",children:[(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/customer/dashboard",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/customer/dashboard")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Dashboard"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/events",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/events")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Events"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/social",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/social")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Social"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/customer/bookings",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/customer/bookings")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Bookings"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/customer/profile",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/customer/profile")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Profile"})}),(0,s.jsx)(g.Wq,{className:"px-2 py-1.5 rounded-lg cursor-pointer block",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.1,hoverScale:1.01,hoverLift:-.5,transitionDuration:100,children:(0,s.jsx)(i(),{href:"/customer/admin-request-status",className:"text-sm font-medium block w-full h-full ".concat(a.includes("/customer/admin-request-status")?"text-primary":"text-gray-600 hover:text-gray-900"),children:"Admin Request"})})]}),!v&&(0,s.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,s.jsx)(h,{href:"/",isActive:"/"===a,children:"Home"}),(0,s.jsx)(h,{href:"/events",isActive:a.includes("/events"),children:"Events"}),(0,s.jsx)(h,{href:"/about",isActive:a.includes("/about"),children:"About Us"}),(0,s.jsx)(h,{href:"/contact",isActive:a.includes("/contact"),children:"Contact"})]})]}),(0,s.jsx)("div",{className:"hidden md:flex items-center space-x-3 flex-shrink-0",children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E,{}),(0,s.jsx)(g.Wq,{className:"cursor-pointer",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.15,hoverScale:1.02,hoverLift:-1,transitionDuration:150,children:(0,s.jsx)(o.$,{variant:"destructive",size:"sm",onClick:W,className:"px-3 py-1.5 text-sm",children:"Logout"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.z,{href:"/login",variant:"outline",size:"sm",className:"px-3 py-1.5 text-sm",children:"Login"}),(0,s.jsx)(l.z,{href:"/register",variant:"primary",size:"sm",className:"px-3 py-1.5 text-sm",children:"Sign Up"})]})}),(0,s.jsx)("button",{className:"md:hidden flex items-center",onClick:()=>d(!c),children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-6 h-6",children:c?(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),c&&(0,s.jsx)("div",{className:"md:hidden bg-white border-t border-gray-100 py-3",children:(0,s.jsxs)("div",{className:"container mx-auto px-2 flex flex-col space-y-3",children:[((null==v?void 0:v.role)==="ADMIN"||(null==v?void 0:v.is_org_admin))&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i(),{href:"/admin/dashboard",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat((null==a?void 0:a.includes("/admin/dashboard"))?"text-primary bg-primary/10":"text-gray-600"),children:"Dashboard"}),(0,s.jsx)(i(),{href:"/admin/event",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/admin/event")?"text-primary bg-primary/10":"text-gray-600"),children:"Add Event"}),(0,s.jsx)(i(),{href:"/admin/category",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/admin/category")?"text-primary bg-primary/10":"text-gray-600"),children:"Categories"}),(0,s.jsx)(i(),{href:"/admin/events",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/admin/events")?"text-primary bg-primary/10":"text-gray-600"),children:"Events"}),(0,s.jsx)(i(),{href:"/admin/bookings",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/admin/bookings")?"text-primary bg-primary/10":"text-gray-600"),children:"Bookings"}),(0,s.jsx)(i(),{href:"/admin/customers",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/admin/customers")?"text-primary bg-primary/10":"text-gray-600"),children:"Customers"}),(0,s.jsx)(i(),{href:"/admin/register",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/admin/register")?"text-primary bg-primary/10":"text-gray-600"),children:"Register"})]}),(null==v?void 0:v.role)==="customer"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i(),{href:"/customer/dashboard",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/customer/dashboard")?"text-primary bg-primary/10":"text-gray-600"),children:"Dashboard"}),(0,s.jsx)(i(),{href:"/events",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/events")?"text-primary bg-primary/10":"text-gray-600"),children:"Events"}),(0,s.jsx)(i(),{href:"/social",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/social")?"text-primary bg-primary/10":"text-gray-600"),children:"Social"}),(0,s.jsx)(i(),{href:"/customer/bookings",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/customer/bookings")?"text-primary bg-primary/10":"text-gray-600"),children:"Bookings"}),(0,s.jsx)(i(),{href:"/customer/profile",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/customer/profile")?"text-primary bg-primary/10":"text-gray-600"),children:"Profile"})]}),v&&j&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"border-t border-gray-200 pt-4 mt-4",children:[(0,s.jsx)("div",{className:"px-3 py-2 text-xs font-semibold text-gray-500 uppercase tracking-wider",children:"Organization"}),(0,s.jsx)(i(),{href:"/organization/dashboard",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat((null==a?void 0:a.includes("/organization/dashboard"))?"text-primary bg-primary/10":"text-gray-600"),children:"Dashboard"}),(0,s.jsx)(i(),{href:"/organization/events",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat((null==a?void 0:a.includes("/organization/events"))?"text-primary bg-primary/10":"text-gray-600"),children:"Events"}),k&&(0,s.jsx)(i(),{href:"/organization/members",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/organization/members")?"text-primary bg-primary/10":"text-gray-600"),children:"Members"}),_&&(0,s.jsx)(i(),{href:"/organization/spaces",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/organization/spaces")?"text-primary bg-primary/10":"text-gray-600"),children:"Event Spaces"}),w&&(0,s.jsx)(i(),{href:"/organization/settings",className:"text-sm font-medium block py-1.5 px-2 rounded-lg hover:bg-gray-50 ".concat(a.includes("/organization/settings")?"text-primary bg-primary/10":"text-gray-600"),children:"Settings"})]})}),!v&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i(),{href:"/",className:"text-sm font-medium block py-2 px-3 rounded-lg hover:bg-gray-50 ".concat("/"===a?"text-primary bg-primary/10":"text-gray-600"),children:"Home"}),(0,s.jsx)(i(),{href:"/events",className:"text-sm font-medium block py-2 px-3 rounded-lg hover:bg-gray-50 ".concat(a.includes("/events")?"text-primary bg-primary/10":"text-gray-600"),children:"Events"}),(0,s.jsx)(i(),{href:"/about",className:"text-sm font-medium block py-2 px-3 rounded-lg hover:bg-gray-50 ".concat(a.includes("/about")?"text-primary bg-primary/10":"text-gray-600"),children:"About Us"}),(0,s.jsx)(i(),{href:"/contact",className:"text-sm font-medium block py-2 px-3 rounded-lg hover:bg-gray-50 ".concat(a.includes("/contact")?"text-primary bg-primary/10":"text-gray-600"),children:"Contact"})]}),v?(0,s.jsx)(g.Wq,{className:"w-full mt-4 cursor-pointer",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.15,hoverScale:1.02,hoverLift:-1,transitionDuration:150,children:(0,s.jsx)(o.$,{variant:"destructive",size:"sm",onClick:W,className:"w-full mt-4",children:"Logout"})}):(0,s.jsxs)("div",{className:"flex flex-col space-y-2 mt-4",children:[(0,s.jsx)(l.z,{href:"/login",variant:"outline",size:"sm",className:"w-full",children:"Login"}),(0,s.jsx)(l.z,{href:"/register",variant:"primary",size:"sm",className:"w-full",children:"Sign Up"})]})]})})]})}},50959:(e,r,t)=>{t.d(r,{E:()=>l,NotificationProvider:()=>c});var s=t(95155),a=t(12115),i=t(11712),n=t(17146);let o=(0,a.createContext)(void 0),l=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("useNotifications must be used within a NotificationProvider");return e},c=e=>{let{children:r}=e,{user:t}=(0,n.A)(),[l,c]=(0,a.useState)([]),[d,h]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),[u,g]=(0,a.useState)(!1),[p,y]=(0,a.useState)(null),f=async()=>{if(t)try{g(!0);let{data:e,error:r}=await i.ND.from("notifications").select("*").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(50);if(r)throw r;c(e||[])}catch(e){console.error("Error loading notifications:",e)}finally{g(!1)}},v=async()=>{if(t)try{let{data:e,error:r}=await i.ND.from("notification_preferences").select("*").eq("user_id",t.id).single();if(r&&"PGRST116"!==r.code)throw r;if(e)h(e);else{let{data:e,error:r}=await i.ND.from("notification_preferences").insert({user_id:t.id,email_notifications:!0,push_notifications:!0,event_reminders:!0,booking_reminders:!0,follow_updates:!0,category_updates:!0,reminder_hours:24}).select().single();if(r)throw r;h(e)}}catch(e){console.error("Error loading notification preferences:",e)}},j=async()=>{if(t)try{let{data:e,error:r}=await i.ND.rpc("get_notification_summary",{p_user_id:t.id});if(r)throw r;let s=e&&e.length>0?e[0]:null;x(s)}catch(a){console.error("Error loading notification summary:",a);let e=l.filter(e=>!e.is_read).length,r=l.filter(e=>"EVENT_REMINDER"===e.type).length,s=l.filter(e=>"BOOKING_CONFIRMED"===e.type).length;x({user_id:t.id,total_notifications:l.length,unread_count:e,reminder_count:r,booking_count:s,latest_notification:l.length>0?l[0].created_at:void 0})}},b=async e=>{if(!t)return!1;try{let{error:r}=await i.ND.rpc("mark_notification_read",{p_notification_id:e});if(r)throw r;return c(r=>r.map(r=>r.id===e?{...r,is_read:!0}:r)),await j(),!0}catch(e){return console.error("Error marking notification as read:",e),!1}},w=async()=>{if(!t)return 0;try{let{data:e,error:r}=await i.ND.rpc("mark_all_notifications_read",{p_user_id:t.id});if(r)throw r;return c(e=>e.map(e=>({...e,is_read:!0}))),await j(),e||0}catch(e){return console.error("Error marking all notifications as read:",e),0}},N=async e=>{if(!t||!d)return!1;try{let{data:r,error:s}=await i.ND.from("notification_preferences").update(e).eq("user_id",t.id).select().single();if(s)throw s;return h(r),!0}catch(e){return console.error("Error updating notification preferences:",e),!1}},k=async e=>{if(!t)throw Error("User not authenticated");try{let{data:r,error:s}=await i.ND.rpc("create_notification",{p_user_id:t.id,p_title:e.title||"",p_message:e.message||"",p_type:e.type||"EVENT_CREATED",p_data:e.data||{},p_scheduled_at:e.scheduled_at||null});if(s)throw s;return r}catch(e){throw console.error("Error creating notification:",e),e}},_=async e=>{if(!t)return!1;try{let{error:r}=await i.ND.from("notifications").delete().eq("id",e).eq("user_id",t.id);if(r)throw r;return c(r=>r.filter(r=>r.id!==e)),await j(),!0}catch(e){return console.error("Error deleting notification:",e),!1}},E=async()=>{if(!t)return 0;try{let{data:e,error:r}=await i.ND.rpc("clean_old_notifications",{days_to_keep:30});if(r)throw r;return await f(),await j(),e||0}catch(e){return console.error("Error clearing old notifications:",e),0}},C=()=>{t&&!p&&y(i.ND.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:"user_id=eq.".concat(t.id)},e=>{let r=e.new;c(e=>[r,...e]),j()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:"user_id=eq.".concat(t.id)},e=>{let r=e.new;c(e=>e.map(e=>e.id===r.id?r:e)),j()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"notifications",filter:"user_id=eq.".concat(t.id)},e=>{let r=e.old;c(e=>e.filter(e=>e.id!==r.id)),j()}).subscribe())},L=()=>{p&&(i.ND.removeChannel(p),y(null))},M=l.filter(e=>!e.is_read).length;return(0,a.useEffect)(()=>(t?(f(),v(),j(),C()):(c([]),h(null),x(null),L()),()=>{L()}),[t]),(0,s.jsx)(o.Provider,{value:{notifications:l,preferences:d,summary:m,loading:u,unreadCount:M,loadNotifications:f,loadPreferences:v,loadSummary:j,markAsRead:b,markAllAsRead:w,updatePreferences:N,createNotification:k,deleteNotification:_,clearOldNotifications:E,subscribeToNotifications:C,unsubscribeFromNotifications:L},children:r})}}}]);
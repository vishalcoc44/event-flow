(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1016],{67892:(e,s,t)=>{Promise.resolve().then(t.bind(t,34528))},34528:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>A});var a=t(95155),r=t(12115),l=t(30784),n=t(56345),i=t(22130),c=t(85217),o=t(51719),d=t(21567);let m=c.bL,u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(c.q7,{ref:s,className:(0,d.cn)("border-b",t),...r})});u.displayName="AccordionItem";let x=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsx)(c.Y9,{className:"flex",children:(0,a.jsxs)(c.l9,{ref:s,className:(0,d.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...l,children:[r,(0,a.jsx)(o.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});x.displayName="AccordionTrigger";let h=r.forwardRef((e,s)=>{let{className:t,children:r,...l}=e;return(0,a.jsx)(c.UC,{ref:s,className:(0,d.cn)("overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",t),...l,children:(0,a.jsx)("div",{className:"pb-4 pt-0",children:r})})});h.displayName="AccordionContent";var g=t(25121),f=t(35055),N=t(71714),v=t(47548),y=t(4370),j=t(17146),p=t(66462),b=t(43831),w=t(57223),k=t(32423),C=t(66889),E=t(67427);function A(){let{customers:e,loading:s,error:t}=(0,l.d)(),{bookings:c}=(0,n.W)(),{user:o}=(0,j.A)(),[d,A]=(0,r.useState)({});(0,r.useEffect)(()=>{A(e.reduce((e,s)=>(e[s.id]=c.filter(e=>e.user_id===s.id),e),{}))},[e,c]);let _=(e,s,t)=>e&&s?"".concat(e[0]).concat(s[0]).toUpperCase():e?e[0].toUpperCase():t?t[0].toUpperCase():"U",B={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:20}}};return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-white",children:[(0,a.jsx)(v.A,{user:o?{role:"USER"===o.role?"customer":o.role}:null}),(0,a.jsxs)("main",{className:"flex-grow container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Customers"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage and view all registered customers"})]}),s?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(N.P.div,{className:"w-12 h-12 border-4 border-t-[#6CDAEC] rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}):t?(0,a.jsx)("div",{className:"bg-red-50 p-4 rounded-md text-red-800",children:(0,a.jsxs)("p",{children:["Error loading customers: ",t]})}):0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("h3",{className:"text-xl font-medium text-gray-600 mb-4",children:"No customers found"}),(0,a.jsx)("p",{className:"text-gray-500",children:"There are no registered customers in the system yet."})]}):(0,a.jsx)(N.P.div,{className:"space-y-6",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},children:e.map(e=>{var s,t;return(0,a.jsx)(N.P.div,{variants:B,children:(0,a.jsx)(E.Wq,{className:"cursor-pointer",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.15,hoverScale:1.02,hoverLift:-1,transitionDuration:150,children:(0,a.jsxs)(i.Zp,{className:"overflow-hidden border border-gray-200 shadow-sm",children:[(0,a.jsx)(i.aR,{className:"bg-white border-b",children:(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(f.eu,{className:"h-12 w-12 bg-[#6CDAEC] text-white",children:(0,a.jsx)(f.q5,{children:_(e.first_name,e.last_name,e.email)})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(i.ZB,{className:"text-lg font-semibold text-gray-900",children:[e.first_name," ",e.last_name||"",!e.first_name&&!e.last_name&&(e.username||e.email)]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Customer since ",e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"]})]})]})}),(0,a.jsxs)(i.Wu,{className:"pt-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("span",{className:"text-gray-700",children:e.email})]}),e.contact_number&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("span",{className:"text-gray-700",children:e.contact_number})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[e.city&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("span",{className:"text-gray-700",children:[e.street_address&&"".concat(e.street_address,", "),e.city,e.pincode&&", ".concat(e.pincode)]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(k.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("span",{className:"text-gray-700",children:[(null===(s=d[e.id])||void 0===s?void 0:s.length)||0," bookings"]})]})]})]}),(null===(t=d[e.id])||void 0===t?void 0:t.length)>0&&(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(m,{type:"single",collapsible:!0,className:"w-full",children:(0,a.jsxs)(u,{value:"bookings",className:"border-b-0",children:[(0,a.jsx)(x,{className:"py-2 text-gray-900",children:"Booking History"}),(0,a.jsx)(h,{children:(0,a.jsx)("div",{className:"space-y-3 mt-2",children:d[e.id].map(e=>{var s,t,r;return(0,a.jsx)("div",{className:"p-3 bg-gray-50 rounded-md",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:(null===(s=e.event)||void 0===s?void 0:s.title)||"Unknown Event"}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(k.A,{className:"h-3 w-3"}),(null===(t=e.event)||void 0===t?void 0:t.date)?new Date(e.event.date).toLocaleDateString():"N/A"]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(C.A,{className:"h-3 w-3"}),(null===(r=e.event)||void 0===r?void 0:r.time)||"N/A"]})]})]}),(0,a.jsx)(g.E,{className:"CONFIRMED"===e.status?"bg-green-100 text-green-800":"PENDING"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",children:e.status})]})},e.id)})})})]})})})]})]})})},e.id)})})]}),(0,a.jsx)(y.A,{})]})}},35055:(e,s,t)=>{"use strict";t.d(s,{BK:()=>c,eu:()=>i,q5:()=>o});var a=t(95155),r=t(12115),l=t(58078),n=t(21567);let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.bL,{ref:s,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r})});i.displayName=l.bL.displayName;let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l._V,{ref:s,className:(0,n.cn)("aspect-square h-full w-full",t),...r})});c.displayName=l._V.displayName;let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(l.H4,{ref:s,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r})});o.displayName=l.H4.displayName},56345:(e,s,t)=>{"use strict";t.d(s,{BookingProvider:()=>i,W:()=>c});var a=t(95155),r=t(12115),l=t(85534);let n=(0,r.createContext)(void 0),i=e=>{let{children:s}=e,[t,i]=(0,r.useState)([]),[c,o]=(0,r.useState)(!0),[d,m]=(0,r.useState)(null),u=async()=>{try{o(!0),m(null);let e=await l.Bn.getAllBookings();i(e||[])}catch(e){console.error("Error fetching bookings:",e),m(e.message||"Failed to fetch bookings")}finally{o(!1)}};(0,r.useEffect)(()=>{u()},[]);let x=async e=>{try{o(!0),m(null);let s=await l.Bn.createBooking(e);return s&&i(e=>[...e,s]),s}catch(e){return console.error("Error adding booking:",e),m(e.message||"Failed to add booking"),null}finally{o(!1)}},h=async e=>{try{o(!0),m(null);let s=await l.Bn.cancelBooking(e);return s&&i(s=>s.map(s=>s.id===e?{...s,status:"CANCELLED"}:s)),s}catch(e){return console.error("Error cancelling booking:",e),m(e.message||"Failed to cancel booking"),null}finally{o(!1)}},g=async()=>{try{return o(!0),m(null),await l.Bn.getUserBookings()||[]}catch(e){return console.error("Error getting user bookings:",e),m(e.message||"Failed to get user bookings"),[]}finally{o(!1)}},f=async()=>{try{return o(!0),m(null),await l.Bn.getAllBookings()||[]}catch(e){return console.error("Error getting all bookings:",e),m(e.message||"Failed to get all bookings"),[]}finally{o(!1)}};return(0,a.jsx)(n.Provider,{value:{bookings:t,loading:c,error:d,addBooking:x,cancelBooking:h,getUserBookings:g,getAllBookings:f,fetchBookings:u},children:s})},c=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useBookings must be used within a BookingProvider");return e}},30784:(e,s,t)=>{"use strict";t.d(s,{CustomerProvider:()=>i,d:()=>c});var a=t(95155),r=t(12115),l=t(11712);let n=(0,r.createContext)(void 0),i=e=>{let{children:s}=e,[t,i]=(0,r.useState)([]),[c,o]=(0,r.useState)(!0),[d,m]=(0,r.useState)(null),u=async()=>{try{o(!0),m(null);let{data:e,error:s}=await l.ND.from("users").select("*").eq("role","USER");if(s)throw s;i(e||[])}catch(e){console.error("Error fetching customers:",e),m(e.message||"Failed to fetch customers")}finally{o(!1)}};return(0,r.useEffect)(()=>{u()},[]),(0,a.jsx)(n.Provider,{value:{customers:t,loading:c,error:d,fetchCustomers:u},children:s})},c=()=>{let e=(0,r.useContext)(n);if(void 0===e)throw Error("useCustomers must be used within a CustomerProvider");return e}}},e=>{var s=s=>e(e.s=s);e.O(0,[1181,6232,3081,2809,7506,2587,4934,8455,975,5534,8441,1517,7358],()=>s(67892)),_N_E=e.O()}]);
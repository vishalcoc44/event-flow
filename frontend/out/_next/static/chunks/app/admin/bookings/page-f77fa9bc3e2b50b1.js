(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6907],{72073:(e,s,t)=>{Promise.resolve().then(t.bind(t,97642))},32423:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},51719:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},66889:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},14807:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},57223:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},1466:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(67401).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},97642:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var a=t(95155),i=t(56345),r=t(22130),n=t(73312),l=t(25121),o=t(71714),c=t(25683),d=t(12115);let h=(0,t(67401).A)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var u=t(51719),m=t(1466),x=t(32423),g=t(66889),v=t(57223),y=t(14807),p=t(47548),f=t(4370),j=t(17146),N=t(7223),b=t(67427);function k(){let{bookings:e,loading:s,error:t,cancelBooking:k}=(0,i.W)(),{user:A}=(0,j.A)(),{toast:w}=(0,N.dj)(),[E,S]=(0,d.useState)([]),[C,D]=(0,d.useState)(null),T={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{type:"spring",stiffness:300,damping:20}}},_={hidden:{height:0,opacity:0},visible:{height:"auto",opacity:1,transition:{duration:.3}}},B=e=>{S(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},M=async e=>{try{D(e),await k(e)&&w({title:"Booking Cancelled",description:"The booking has been successfully cancelled"})}catch(e){w({title:"Error",description:e.message||"Failed to cancel booking",variant:"destructive"})}finally{D(null)}},O=e=>{switch(e.toUpperCase()){case"CONFIRMED":return"bg-green-100 text-green-800";case"PENDING":return"bg-yellow-100 text-yellow-800";case"CANCELLED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-white",children:[(0,a.jsx)(p.A,{user:A?{role:"USER"===A.role?"customer":A.role}:null}),(0,a.jsxs)("main",{className:"flex-grow container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"All Bookings"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage customer bookings for all events"})]}),s?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(o.P.div,{className:"w-12 h-12 border-4 border-t-[#6CDAEC] rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})}):t?(0,a.jsx)("div",{className:"bg-red-50 p-4 rounded-md text-red-800",children:(0,a.jsxs)("p",{children:["Error loading bookings: ",t]})}):0===e.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("h3",{className:"text-xl font-medium text-gray-600 mb-4",children:"No bookings found"}),(0,a.jsx)("p",{className:"text-gray-500",children:"There are no bookings in the system yet."})]}):(0,a.jsx)(o.P.div,{className:"space-y-4",initial:"hidden",animate:"visible",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},children:(0,a.jsx)(c.N,{children:e.map(e=>{var s,t,i,d,p,f,j,N,k;return(0,a.jsx)(o.P.div,{variants:T,layout:!0,children:(0,a.jsx)(b.Wq,{className:"cursor-pointer",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.15,hoverScale:1.02,hoverLift:-1,transitionDuration:150,children:(0,a.jsxs)(r.Zp,{className:"overflow-hidden border border-gray-200 shadow-sm",children:[(0,a.jsx)(r.aR,{className:"bg-white border-b cursor-pointer",onClick:()=>B(e.id),children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[(0,a.jsx)(r.ZB,{className:"text-lg font-semibold text-gray-900",children:(null===(s=e.event)||void 0===s?void 0:s.title)||"Unknown Event"}),(0,a.jsx)(l.E,{className:O(e.status),children:e.status})]}),E.includes(e.id)?(0,a.jsx)(h,{className:"text-gray-500 h-5 w-5"}):(0,a.jsx)(u.A,{className:"text-gray-500 h-5 w-5"})]})}),(0,a.jsx)(c.N,{children:E.includes(e.id)&&(0,a.jsxs)(o.P.div,{variants:_,initial:"hidden",animate:"visible",exit:"hidden",children:[(0,a.jsx)(r.Wu,{className:"pt-4 pb-2",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Customer:"})," ",null===(t=e.user)||void 0===t?void 0:t.first_name," ",(null===(i=e.user)||void 0===i?void 0:i.last_name)||(null===(d=e.user)||void 0===d?void 0:d.username)||(null===(p=e.user)||void 0===p?void 0:p.email)]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Event Date:"})," ",(null===(f=e.event)||void 0===f?void 0:f.date)?new Date(e.event.date).toLocaleDateString():"N/A"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Event Time:"})," ",(null===(j=e.event)||void 0===j?void 0:j.time)||"N/A"]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Location:"})," ",(null===(N=e.event)||void 0===N?void 0:N.location)||"N/A"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Price:"})," ","$",(null===(k=e.event)||void 0===k?void 0:k.price)||"N/A"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Booking Date:"})," ",e.booking_date?new Date(e.booking_date).toLocaleDateString():e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"]})]})]})]})}),(0,a.jsx)(r.wL,{className:"border-t bg-gray-50 py-3",children:(0,a.jsx)("div",{className:"flex justify-end w-full",children:"CANCELLED"!==e.status&&(0,a.jsx)(b.Wq,{className:"cursor-pointer",shadowColor:"rgba(0,0,0,0.1)",shadowIntensity:.15,hoverScale:1.02,hoverLift:-1,transitionDuration:150,children:(0,a.jsx)(n.$,{variant:"destructive",size:"sm",onClick:()=>M(e.id),disabled:C===e.id,children:C===e.id?"Cancelling...":"Cancel Booking"})})})})]})})]})})},e.id)})})})]}),(0,a.jsx)(f.A,{})]})}},7223:(e,s,t)=>{"use strict";t.d(s,{dj:()=>u,oR:()=>h});var a=t(12115);let i=0,r=new Map,n=e=>{if(r.has(e))return;let s=setTimeout(()=>{r.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,s)},l=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?n(t):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},o=[],c={toasts:[]};function d(e){c=l(c,e),o.forEach(e=>{e(c)})}function h(e){let{...s}=e,t=(i=(i+1)%Number.MAX_VALUE).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:t});return d({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,s]=a.useState(c);return a.useEffect(()=>(o.push(s),()=>{let e=o.indexOf(s);e>-1&&o.splice(e,1)}),[e]),{...e,toast:h,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},56345:(e,s,t)=>{"use strict";t.d(s,{BookingProvider:()=>l,W:()=>o});var a=t(95155),i=t(12115),r=t(85534);let n=(0,i.createContext)(void 0),l=e=>{let{children:s}=e,[t,l]=(0,i.useState)([]),[o,c]=(0,i.useState)(!0),[d,h]=(0,i.useState)(null),u=async()=>{try{c(!0),h(null);let e=await r.Bn.getAllBookings();l(e||[])}catch(e){console.error("Error fetching bookings:",e),h(e.message||"Failed to fetch bookings")}finally{c(!1)}};(0,i.useEffect)(()=>{u()},[]);let m=async e=>{try{c(!0),h(null);let s=await r.Bn.createBooking(e);return s&&l(e=>[...e,s]),s}catch(e){return console.error("Error adding booking:",e),h(e.message||"Failed to add booking"),null}finally{c(!1)}},x=async e=>{try{c(!0),h(null);let s=await r.Bn.cancelBooking(e);return s&&l(s=>s.map(s=>s.id===e?{...s,status:"CANCELLED"}:s)),s}catch(e){return console.error("Error cancelling booking:",e),h(e.message||"Failed to cancel booking"),null}finally{c(!1)}},g=async()=>{try{return c(!0),h(null),await r.Bn.getUserBookings()||[]}catch(e){return console.error("Error getting user bookings:",e),h(e.message||"Failed to get user bookings"),[]}finally{c(!1)}},v=async()=>{try{return c(!0),h(null),await r.Bn.getAllBookings()||[]}catch(e){return console.error("Error getting all bookings:",e),h(e.message||"Failed to get all bookings"),[]}finally{c(!1)}};return(0,a.jsx)(n.Provider,{value:{bookings:t,loading:o,error:d,addBooking:m,cancelBooking:x,getUserBookings:g,getAllBookings:v,fetchBookings:u},children:s})},o=()=>{let e=(0,i.useContext)(n);if(void 0===e)throw Error("useBookings must be used within a BookingProvider");return e}}},e=>{var s=s=>e(e.s=s);e.O(0,[1181,6232,3081,2809,7506,4934,8455,975,5534,8441,1517,7358],()=>s(72073)),_N_E=e.O()}]);
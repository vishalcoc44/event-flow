(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2655],{95329:(e,t,s)=>{Promise.resolve().then(s.bind(s,90534))},90534:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(95155),a=s(12115),i=s(17146),n=s(11712),l=s(47548),d=s(4370),o=s(73312),c=s(22130),u=s(25121),m=s(46754),x=s(51344),p=s(7223);function f(){let{user:e}=(0,i.A)(),{toast:t}=(0,p.dj)(),[s,f]=(0,a.useState)([]),[h,g]=(0,a.useState)(!0),[j,v]=(0,a.useState)(null),[N,y]=(0,a.useState)(""),[b,_]=(0,a.useState)(null),[w,E]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!e||"ADMIN"!==e.role&&!e.is_org_admin){window.location.href="/login";return}q()},[e]);let q=async()=>{try{g(!0);let{data:e,error:s}=await n.ND.rpc("get_pending_admin_requests");if(s){console.error("Error fetching admin requests:",s),t({title:"Error",description:"Failed to fetch admin requests",variant:"destructive"});return}f(e||[])}catch(e){console.error("Error fetching admin requests:",e),t({title:"Error",description:"Failed to fetch admin requests",variant:"destructive"})}finally{g(!1)}},A=async s=>{if(e)try{v(s);let{error:r}=await n.ND.rpc("approve_admin_request",{p_request_id:s,p_reviewer_id:e.id,p_review_notes:N});if(r){console.error("Error approving request:",r),t({title:"Error",description:"Failed to approve admin request",variant:"destructive"});return}t({title:"Success",description:"Admin request approved successfully"}),await q(),E(!1),y(""),_(null)}catch(e){console.error("Error approving request:",e),t({title:"Error",description:"Failed to approve admin request",variant:"destructive"})}finally{v(null)}},S=async s=>{if(!e||!N.trim()){t({title:"Error",description:"Please provide a reason for rejection",variant:"destructive"});return}try{v(s);let{error:r}=await n.ND.rpc("reject_admin_request",{p_request_id:s,p_reviewer_id:e.id,p_review_notes:N});if(r){console.error("Error rejecting request:",r),t({title:"Error",description:"Failed to reject admin request",variant:"destructive"});return}t({title:"Success",description:"Admin request rejected successfully"}),await q(),E(!1),y(""),_(null)}catch(e){console.error("Error rejecting request:",e),t({title:"Error",description:"Failed to reject admin request",variant:"destructive"})}finally{v(null)}},T=(e,t)=>{_(e),y(""),E(!0)},R=e=>{switch(e){case"BEGINNER":return"bg-blue-100 text-blue-800";case"INTERMEDIATE":return"bg-yellow-100 text-yellow-800";case"EXPERIENCED":return"bg-orange-100 text-orange-800";case"EXPERT":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return(null==e?void 0:e.role)!=="ADMIN"?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Access Denied"}),(0,r.jsx)("p",{className:"text-gray-600",children:"You need admin privileges to access this page."})]})}):(0,r.jsxs)("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[(0,r.jsx)(l.A,{}),(0,r.jsx)("main",{className:"flex-grow py-8",children:(0,r.jsxs)("div",{className:"container mx-auto px-4",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Requests"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Review and manage requests for admin privileges"})]}),h?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):0===s.length?(0,r.jsx)(c.Zp,{children:(0,r.jsx)(c.Wu,{className:"py-12",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Pending Requests"}),(0,r.jsx)("p",{className:"text-gray-600",children:"All admin requests have been processed."})]})})}):(0,r.jsx)("div",{className:"grid gap-6",children:s.map(e=>(0,r.jsxs)(c.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,r.jsx)(c.aR,{children:(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[e.first_name," ",e.last_name,(0,r.jsx)(u.E,{variant:"outline",className:R(e.experience_level),children:e.experience_level})]}),(0,r.jsxs)(c.BT,{children:[e.email," â€¢ ",e.contact_number]})]}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()})]})}),(0,r.jsx)(c.Wu,{children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"Reason for Admin Access"}),(0,r.jsx)("p",{className:"text-gray-600",children:e.reason})]}),e.organization&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"Organization"}),(0,r.jsx)("p",{className:"text-gray-600",children:e.organization})]}),e.intended_use&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:"Intended Use"}),(0,r.jsx)("p",{className:"text-gray-600",children:e.intended_use})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-4",children:[(0,r.jsx)(o.$,{onClick:()=>T(e,"approve"),className:"bg-green-600 hover:bg-green-700",disabled:j===e.request_id,children:j===e.request_id?"Processing...":"Approve"}),(0,r.jsx)(o.$,{onClick:()=>T(e,"reject"),variant:"destructive",disabled:j===e.request_id,children:j===e.request_id?"Processing...":"Reject"})]})]})})]},e.request_id))})]})}),(0,r.jsx)(x.lG,{open:w,onOpenChange:E,children:(0,r.jsxs)(x.Cf,{className:"sm:max-w-md",children:[(0,r.jsxs)(x.c7,{children:[(0,r.jsx)(x.L3,{children:"Review Admin Request"}),(0,r.jsx)(x.rr,{children:b&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Applicant:"})," ",b.first_name," ",b.last_name]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Email:"})," ",b.email]})]})})]}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{htmlFor:"review-notes",className:"block text-sm font-medium text-gray-700 mb-1",children:["Review Notes ",b&&" (Required for rejection)"]}),(0,r.jsx)(m.T,{id:"review-notes",placeholder:"Add your review notes here...",value:N,onChange:e=>y(e.target.value),rows:4})]})}),(0,r.jsxs)(x.Es,{children:[(0,r.jsx)(o.$,{variant:"outline",onClick:()=>{E(!1),y(""),_(null)},children:"Cancel"}),(0,r.jsx)(o.$,{onClick:()=>{b&&A(b.request_id)},className:"bg-green-600 hover:bg-green-700",disabled:j===(null==b?void 0:b.request_id),children:j===(null==b?void 0:b.request_id)?"Processing...":"Approve"}),(0,r.jsx)(o.$,{onClick:()=>{b&&S(b.request_id)},variant:"destructive",disabled:j===(null==b?void 0:b.request_id)||!N.trim(),children:j===(null==b?void 0:b.request_id)?"Processing...":"Reject"})]})]})}),(0,r.jsx)(d.A,{})]})}},51344:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>p,L3:()=>f,c7:()=>x,lG:()=>d,rr:()=>h,zM:()=>o});var r=s(95155),a=s(12115),i=s(84290),n=s(40767),l=s(21567);let d=i.bL,o=i.l9,c=e=>{let{className:t,...s}=e;return(0,r.jsx)(i.ZL,{...s,children:(0,r.jsx)("div",{className:(0,l.cn)(t),children:s.children})})};c.displayName=i.ZL.displayName;let u=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.hJ,{ref:t,className:(0,l.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...a})});u.displayName=i.hJ.displayName;let m=(0,a.forwardRef)((e,t)=>{let{className:s,children:a,...d}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(u,{}),(0,r.jsxs)(i.UC,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",s),...d,children:[a,(0,r.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=i.UC.displayName;let x=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};x.displayName="DialogHeader";let p=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};p.displayName="DialogFooter";let f=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.hE,{ref:t,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",s),...a})});f.displayName=i.hE.displayName;let h=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(i.VY,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});h.displayName=i.VY.displayName},46754:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var r=s(95155),a=s(12115),i=s(21567);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});n.displayName="Textarea"},7223:(e,t,s)=>{"use strict";s.d(t,{dj:()=>m,oR:()=>u});var r=s(12115);let a=0,i=new Map,n=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],o={toasts:[]};function c(e){o=l(o,e),d.forEach(e=>{e(o)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_VALUE).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=r.useState(o);return r.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var t=t=>e(e.s=t);e.O(0,[1181,6232,3081,2809,7506,8472,4290,4934,8455,975,8441,1517,7358],()=>t(95329)),_N_E=e.O()}]);